"0","#Code for the fifth graph"
"0",""
"0","#tidy up the column of mechanic and category with cSplit function"
"0","library(splitstackshape)"
"0","board_game_tidy <- cSplit(board_game,splitCols=c(""mechanic"",""category""), sep = "","", direction = ""long"")"
"0",""
"0","#use piping to isolate all the category and average complexity from board_game_tidy under conditions"
"0","library(dplyr)"
"0","new_category_complexity <- board_game_tidy %>% "
"0","            filter(average_complexity > 0, yearpublished >= 1950, users_rated >= 25) %>%"
"0","            select(category, average_complexity) %>%"
"0","            group_by(category)"
"0","#eliminate all the NA in new_category_complexity"
"0","new_category_complexity <- na.omit(new_category_complexity) "
"0","#use piping to takes the mean of average complexity from rows with identical category and arrange category in descending order of mean complexity"
"0","new_category_complexity <- new_category_complexity %>% "
"0","                           group_by(category) %>%"
"0","                           mutate(my_average = mean(average_complexity)) %>%"
"0","                           select(-average_complexity) %>%"
"0","                           distinct()"
"0","#take the top 15 category with the highest mean complexity from "
"0","top15_average <- new_category_complexity %>% "
"0","                arrange(desc(my_average)) %>%"
"0","                head(15)"
"0","#Plot the relationship between the top 15 category with the highest level of average complexity"
"0","#create a bar graph"
"0","category_complexity_graph <- ggplot(data=top15_average, aes(x = reorder(category, -my_average), y = my_average, na.rm = TRUE)) + "
"0","        geom_bar(stat = ""identity"",position = 'dodge', na.rm = TRUE, color=""white"",fill=""sky blue"") + "
"0","        #set the scale of y-axis to a range of 0 to 3.5"
"0","        ylim(0,3.5) + "
"0","        #set the break unit of the y-axis to be 0.5 to show smaller difference"
"0","        scale_y_continuous(breaks=seq(0, 3.5, 0.5)) + "
"0","        # label the values in the top of bars"
"0","        geom_text(aes(label=round(my_average, digits = 2)), position=position_dodge(width=0.005), vjust = -0.05, hjust=0.5) + "
"0","        #set the background to be black and white"
"0","        theme_bw() +"
"0","        #set the title of the graph"
"0","        ggtitle(""Which category of board games has the highest level of average complexity"") + "
"0","        #set the caption of the x axis"
"0","        xlab(""category of board games"") + "
"0","        #set the caption of the y axis"
"0","        ylab(""average complexity of the board game"") + "
"0","        #set the size and angle of the categorical variable in x axis "
"0","        theme(axis.text.x = element_text(size=10,angle = 45)) + "
"0","        #center the title of the graph"
"0","        theme(plot.title = element_text(hjust = 0.5)) "
"0","category_complexity_graph"
"0",""
